- Image 컴포넌트를 사용할 때는 기본 폭과 높이를 알아야 한다. 스크린에 원하는 폭과 높이가 아니라, 렌더링 하고자 하는 이미지의 폭과 넓이이다.
- 이미지의 치수를 알수 없다면 fill 이 좋은 대안이 될 수 있다.
- better-sqlite3 는 로컬에서 사용할 수 있는 sql db 이다.
- run(데이터를 바꿀 때), all(데이터를 가져올 때), get(데이터를 가져오는데 하나의 열만 가져올 때)
- 서버 컴포넌트는 클라이언트 컴포넌트와 달리 async를 붙일 수 있다. 그리고 서버컴포넌트는 서버에서만 실행되기 때문에 그 안에서 데이터를 가져오는 것은 사이드 이펙트가 아니다. 굳이 useEffect로 감싸지 않고 데이터를 바로 패치하면 된다.
- loading 파일은 데이터가 올 때 까지 page 파일 대신 대체로 보여진다.
- 특정 부분만 로딩 화면을 보려주려면 React의 Suspense 컴포넌트의 fallback 에 대체할 컴포넌트를 넣어주면 된다.
- error 파일로 해당 파일이 있는 바운더리 안에 일어난 에러를 처리할 수 있다.
- error 컴포넌트는 클라이언트 컴포넌트여야 한다. Nextjs는 기본적으로 클라이언트 측에서 발생한 오류를 잡을수 있도록 보장하기 때문이다.
- 루트의 not-found 파일은 라우터에 대한 not-found 에러를 처리한다.
- dangerouslySetInnerHTML 속성을 이용해 html 을 태그에 랜더링 시킬수 있다. 안에 들어갈 값은 객체이고 `__html` 에 html 태그를 넣으면 된다.
- notFound 함수는 가장 가까운 not-found 페이지로 보내줄 것이다.
- 컴포논트 내부에서 함수는 만들고 내부 안에 `'use server'` 라는 지시어를 입력하면 Server Actioin이라는 것을 생성하고, 서버에서만 실행될 수 있게 보장해준다. 추가로 async를 붙여주어야 한다.
- Server Action 은 form 태그에 action 속성의 값으로 할당 가능하다. 그리고 Server Action 함수는 자바스크립트 객체인 formData를 받는다.
- 그 후 해당 객체의 get 메서드에 키를 넣음으로 input에 담겨 보내진 값을 가져올 수 있다.
- 해당 기능을 사용하면 submit 으로 폼을 제출해도 새로고침 안돼소 클라이언트에도 아무 일이 일어나지 않는다. 오직 서버에서만 작동하기 때문이다.
- server action 은 클라이언트 컴포넌트에서 사용할 수 없다.
- server action 함수만 따로 분리해서 작성할 수 있다. 이때 함수 내부 맨 위에 적지 않고 파일 맨 위에 적는 방법으로 수정 가능하다. 이렇게 분리하면 클라이언트 컴포넌트 내부에서도 server action을 사용할 수 있다.
- redirect 함수를 이용해 server action 이 정상적으로 동작한 후 next navigation을 후 다음 페이지로 이동시켜 줄 수 있다.
- react-dom의 useFormStatus 훅을 사용하면 Form 제출 시 서버와의 상태에 대해 알 수 있다. 다만 이건 클라이언트 컴포넌트 에서만 쓸 수 있다. 또한 form 엘리먼트의 안에 있을 때만 form 의 상태를 받을 수 있다.
- 당연한 말이지만 버튼 하나의 상태를 보여주려고 폼 전체를 클라이언트 컴포넌트로 감싸기는 아까우므로 버튼만 따로 분리하여 컴포넌트로 만들면 좋다.
- 유효성 검사는 server action 안에서 하면 된다.
- server action 에서 return 을 하여 response를 반환 가능하다.
- react-dom의 useFormState는 react의 useActionState로 변경 됐다.
- useActionState는 2가지 인자를 받는데, 첫 번째는 form 이 제출될 때 동작하는 실제 server action이고, 두 번째는 초기 상태 값이다.
- 반환 값은 두 가지인데 상태와 액션이다. 상태는 server action으로 받은 최근의 응답 또는 초기 값이고, 액션은 server action 으로 기존 server action 이 있던 자리에 넣어주면 된다.
- 이때 server action도 수정해 줘야 하는데 기존에는 formData 값만 받았다면, useActionState로 만드는 server action 에는 첫 번째 인수가 이전 상태, 두 번째 인수가 기존의 formData 객체이다.
- 이 useActionState도 당연하게도 클라이언트 컴포넌트에서 사용 되므로 따로 분리해 주는게 좋다.